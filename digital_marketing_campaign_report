
Digital Marketing Campaign Report 

Purpose: 
- This report consolidates key performance metrics of a digital marketing campaign.

Highlights: 

1. It gathers essential fields such as click-through rate, conversion rate, conversion, CampaignChannel, CampaignType, Adspend, WebsiteVisits, PagesPerVisit, TimeOnSite, SocialShares, EmailOpens
EmailClicks, PreviousPurchases, LoyaltyPoints, AdvertisingPlatform, Conversion
2. Aggregate customer-level metrics: 
  - Total Conversion 
  - Average Clickthroughrate 
  - Average Conversion Rate and more 


Create Table digital_marketing_campaign (
CustomerID  integer,
Age    integer,
Gender      Varchar,
Income      integer,
CampaignChannel Text,
CampaignType    Text,
AdSpend         Numeric,
ClickThroughRate Numeric,
ConversionRate   Numeric, 
WebsiteVisits     integer, 
PagesPerVist      Numeric, 
TimeOnSite        Numeric,
SocialShares       integer,
EmailOpens         integer,
EmailClicks        integer,
PreviousPurchases  integer,
LoyaltyPoints       integer,
AdvertisingPlatform  Text,
AdvertisingTool      Text,
Conversion integer)






- Find the average ClickThroughRate and ConversionRate for each CampaignType

select
Cast(avg(clickthroughrate) as decimal(10,2)) as avg_clickthroughrate,
Cast(avg(conversionrate) as decimal(10,2)) as avg_conversionrate,
campaigntype
from digital_marketing_campaign
group by campaigntype;



- List the top 5 customers with the highest LoyaltyPoints

select 
customerid,
loyaltypoints,
Row_number() Over(order by loyaltypoints desc) as rn 
from digital_marketing_campaign
group by customerid, digital_marketing_campaign.loyaltypoints
Limit 5;



- Count the number of conversions grouped by AdvertisingPlatform

select 
Advertisingplatform,
count(conversion)
from digital_marketing_campaign
group by advertisingplatform;





- Rank customers by LoyaltyPoints within each CampaignType. 

select 
customerid,
Loyaltypoints, 
campaignType,
dense_rank() Over(partition by campaigntype order by Loyaltypoints desc) as rn 
from digital_marketing_campaign
group by customerid, Loyaltypoints, campaignType; 



